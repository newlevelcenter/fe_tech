$(document).ready(function(){var $body=$("body"),$word=$("#word"),$word_search_ajax=null;$body.on("click",".turn-around",function(e){var $card=$(this).closest(".card");var $video_wrap=$card.find(".card-video-wrap");var word_id=$card.data("user_word_id");var word_video_id=$video_wrap.attr("data-video_id");var video=window[word_video_id];if(video)$video_wrap.attr("data-src",video.src()).data("src",video.src());var src=video?video.src():$video_wrap.data("src");var poster_url=src?src.substr(0,src.length-10)+".jpg":"";var $card_turn_back=$(".card.back-side");if($card_turn_back.length>0&&$card_turn_back.data("user_word_id")!=word_id){$card_turn_back.removeClass("back-side");$card_turn_back.find(".turn-around:first").click()}else{$card.removeClass("back-side")}var side=$card.hasClass("back")?"front":"back",current_side=side=="front"?"back":"front";if(!$card.find(".vocab-card__video").hasClass("no-videos")){$(".vjs-poster",$card).css({"background-image":"url("+poster_url+")"})}video&&video.dispose();delete window[word_video_id];var content=$card.find(".card-"+current_side+" .vocab-card__video").html();$card.find(".card-"+current_side+" .vocab-card__video").html("");$card.find(".card-"+side+" .vocab-card__video").html(content);$card.find(".card-"+side+" .card-video-wrap").html('<div id="word-video'+word_id+'-tmp" data-src="'+src+'" class="word-video'+word_id+'"></div>'+'<img class="poster" src="'+poster_url+'">');$card.find(".wordVideoPlay").show();$card.find(".vocab-card__video").removeClass("is-playing");flipCard($card,side)});$body.on("click",".dict-video__header__search__clear",function(e){$(e.currentTarget).hide();var $ui_autocomplete=$(".ui-autocomplete");if($ui_autocomplete.length!==0)$ui_autocomplete.hide();$("#word").val("")});$("#dictionary_balloon").on("click",function(){ud_displayWord()});$word.on("keydown",function(event){if(event.which==13){event.preventDefault();$word.data("pressed",true);ud_displayWord()}else if(event.which==8){$(".ui-autocomplete").hide();$("#search_preloader").removeClass("pe_autocomplete-loading")}if(event.which!=13){if(typeof window.Balloon.box!=="undefined"&&window.Balloon.box!==null)window.Balloon.box.destroy()}});if(typeof $.ui!=="undefined")$.widget("custom.pe_autocomplete",$.ui.autocomplete,{_renderItem:function(ul,item){var dash="";if(item.translation)dash=" - ";var $li=$("<li>").attr("data-dictionary_page",true).attr("data-word",item.value).attr("data-target","#show_here").attr("data-value",item.value).attr("data-post_type","dictionary").append("<strong>"+item.label+"</strong>"+dash+item.translation).appendTo(ul);if(item.is_english){$li.attr("data-translation",item.translation).addClass("show-balloon");ul.data("is_english",true)}else{ul.data("is_english",false)}return $li}});if(typeof $.ui!=="undefined")$word.pe_autocomplete({appendTo:"#headerSearch",source:function(request,response){if($word_search_ajax)$word_search_ajax.abort();$word_search_ajax=$.ajax({url:window["HOME"],success:function(results){response(results)},data:{ajax_action:"ajax_dictionary_searchWords",word:$("#word").val()},type:"post",dataType:"json"})},select:function(event,ui){if(event.which===13){$(".ui-autocomplete > li.ui-state-focus").click()}},search:function(){$(".dict-video__header__search__clear").hide();$("#search_preloader").addClass("pe_autocomplete-loading")},open:function(){var $autocomplete=$(".ui-autocomplete");if($word.data("pressed")){$word.data("pressed",false);ud_displayWord()}$(".dict-video__header__search__clear").show();$("#search_preloader").removeClass("pe_autocomplete-loading");$autocomplete.css({top:parseInt($autocomplete.css("top"))+8+"px"})},close:function(){$(".dict-video__header__search__clear").show();$("#search_preloader").removeClass("pe_autocomplete-loading")}});$body.on("click",".balloon__content__phrase__source__icon",function(){$(this).parents(".card__content__phrase__source").toggleClass("is-visible")});$body.on("input",".puzzle-search .puzzle-search__input",function(event){event.preventDefault();if($(this).val().length){$(this).parents(".puzzle-search").addClass("puzzle-search_status_focus")}else{$(this).parents(".puzzle-search").removeClass("puzzle-search_status_focus")}});$body.on("click",".puzzle-search .puzzle-icon_close",function(event){event.preventDefault();$(this).siblings(".puzzle-search__input").val("").focus();$(this).parents(".puzzle-search").removeClass("puzzle-search_status_focus")})});function ud_displayWord(){var $ul=$(".ui-autocomplete"),word_to_display={};if($ul.data("is_english")){word_to_display=$('.ui-autocomplete > li[data-word="'+$("#word").val()+'"]')}else{word_to_display=$('.ui-autocomplete > li[data-word="'+$("#word").val()+'"] span.show-balloon:first')}if(word_to_display.length!==0){$ul.hide();word_to_display.click()}}function flipCard($card,side){$card.removeClass("front back back-side").addClass(side);if(side=="back")$card.addClass("back-side");$card=$card.find(".card-wrap");animate($card.get(0),{transform:"rotateY("+(side=="back"?"180deg":"0")+")"},300,"ease",function(){if(typeof callback!=="undefined")callback()})}